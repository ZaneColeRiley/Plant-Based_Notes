function empty(mixed_var){var undef,key,i,len;var emptyValues=[undef,null,false,0,"","0"];for(i=0,len=emptyValues.length;i<len;i++){if(mixed_var===emptyValues[i]){return true;}}
if(typeof mixed_var==="object"){for(key in mixed_var){return false;}
return true;}
return false;}
function dataLayer_push(title){if(!window.dataLayer){return;}
window.dataLayer.push({'event':'embeddedSubmission','pageName':title});}
PMA_FRONT=function($){var PMA={validation:[],cookie_name:'ens_frm_data',cookie_fld_class:'ens_cookie',form_id:'#pma_form',form_populated:'N',init:function(){this.detect_country();this.pma_template=$('#pma_template').val();PMA_FORM.validate_inline(this.form_id);this.init_country_selection('#pma_country','#pma_state');this.populate_form(this.form_id);this.init_tab('.tabbed-content');this.init_toggle('.toggle-content');this.check_peta2_login_status();this.change_section_background();this.remove_p_tags();this.get_interaction_count();if(this.pma_template=='splash_page'||this.pma_template=='default'){var alert_title=this.get_alert_title();if(!empty(alert_title)&&typeof sendEvent==="function"){sendEvent(petaGA_FormCategory_TakeAction,petaGA_FormAction_Initiated,alert_title);}}
if(this.pma_template=='mineral'){this.track_form();}
$('.thermometer-goal').thermometer();$('input, textarea').placeholder();},init_tab:function(selector){$(selector).addClass('tabbed-content-inactive');$(selector).on('click',function(){var tab_target=$(this).data('tab_target');$(selector).removeClass('tabbed-content-active');$(selector).addClass('tabbed-content-inactive');if($(tab_target).css('display')=='none'){$('.toggle_tab').hide();$(tab_target).show();$(this).removeClass('tabbed-content-inactive');$(this).addClass('tabbed-content-active');}else{$(tab_target).hide();}})},detect_country:function(){country_detected=$.cookie('clientLocation');if(typeof country_detected=='undefined'||empty(country_detected)){country_detected='';}
if(country_detected=='[]'||country_detected.indexOf('[')!=-1){country_detected='';}
if(!empty(country_detected)){this.country_detected=country_detected;$('#country_detected').val(country_detected)
$('.pma-country_detected').val(country_detected)
this.handle_casl(country_detected);return country_detected;}
var pma_obj=this;country_detected='NONE';$.getJSON(pma_ajax_url,{action:'detect_country'},function(data,status){if(!empty(data.country)){pma_obj.handle_country_detected_response(data.country);}else{$.get('https://api.peta.org/geoapi/ip/country/',function(data,status){if(!empty(data)){country_detected=data;pma_obj.handle_country_detected_response(country_detected);}else{pma_obj.handle_country_detected_response(country_detected);}});}});},handle_country_detected_response:function(country){country_detected=country;$.cookie('clientLocation',country_detected,{expires:30,path:'/'});this.country_detected=country_detected;$('#country_detected').val(country_detected);$('.pma-country_detected').val(country_detected)
this.handle_casl(country_detected);},handle_casl:function(country){if(empty(country)||country=='CA'||country=='NONE'){$('div.email_optin').show();$('body').addClass('ca-user');$('div.email_optin .form_check').prop('checked',false);$('div.membership-update').show();$('div.membership-update .form_check').prop('checked',false);}else{$('div.email_optin').hide();$('div.email_optin .form_check').prop('checked',true);$('div.membership-update').hide();$('div.membership-update .form_check').prop('checked',true);}
return;},check_peta2_login_status:function(selector){if($('#pma_display_type').val()=='advocacy_splash'){if($('#lguid').length>0){if(!empty($('#lguid').val())){$('#promp-login').hide();}else{$('#promp-login').show();}}
return;}
if($('#lguid').length>0){if(!empty(lguid)){$('#promp-login').hide();$('#lguid').val(lguid);}else{$('#promp-login').show();}}},init_toggle:function(selector){$(selector).on('click',function(){var target=$(this).data('target');$(target).toggle();if($(target).css('display')=='none'){$(this).html('&#43;')}else{$(this).html('&#45;')}})},init_country_selection:function(county_selector,state_selector){var pma_obj=this;$(county_selector).on('change',function(){val=$(this).val();var states=PMA_DATA.states[val];if(!states){states=PMA_DATA.states['NONE'];}
$(state_selector).find('option').remove().end();jQuery.each(states,function(k,v){$(state_selector).append('<option value="'+v.value+'">'+v.label+'</option>');});pma_obj.handle_casl(val);})},get_form_id:function(frm){this.frm_id='#'+$(frm).attr('id');return this.frm_id;},submit_form:function(frm){this.frm=frm;this.frm_id='#'+$(frm).attr('id');pma_obj:this;var validation_status=PMA_FORM.validate(frm);if(validation_status){this.store_form(frm);if($(this.frm_id).data('ajax_submit')=='Y'){this.submit_form_ajax(frm)
return false;}}else{$('#constituent_fields').show();return validation_status;}
return false;},submit_form_ajax:function(frm){this.frm_id=this.get_form_id(frm);this.frm_action=$(this.frm_id).attr('action');this.submit_button=$(this.frm_id).data('submit_button');this.old_submit_label=$(this.submit_button).attr('value');this.loader_selector=$(this.frm_id).data('loader');this.response_target=$(this.frm_id).data('response_target');this.error_response_target=$(frm_id).data('error_response_target');this.loader('start');var pma_obj=this;$.post(pma_ajax_url,$(frm_id).serialize(),function(data){pma_obj.loader('stop');var ens_alert_title=pma_obj.get_alert_title();dataLayer_push(ens_alert_title);if(data.status=='S'&&typeof sendEvent==="function"){sendEvent(petaGA_FormCategory_TakeAction,petaGA_FormAction_Submitted,ens_alert_title);}
pma_obj.response_handler(data)},'json');return false;},get_interaction_count:function(){var ens_id=$('#ens_id').val();if($('.interaction-status-count').length<1||empty(ens_id)){return;}
$.getJSON(pma_ajax_url,{action:'get_interaction_count',ens_id:ens_id},function(data,status){if(!empty(data.interaction_count)){var interaction_count=parseInt(data.interaction_count.replace(/,/g,''));var goal=$('.interaction-status-goal-number').html();if(!empty(goal)){goal=parseInt(goal.replace(/,/g,''));if((interaction_count+100)>goal){goal=interaction_count+5000;$('.interaction-status-goal-number').html(goal.toLocaleString());}}
$('.interaction-status-count').html(data.interaction_count);}});},loader:function(status){if(status=='start'){if(empty(this.loader_selector)){var processing_lablel=$(this.submit_button).data('processing-label');if(empty(processing_lablel)){processing_lablel='Processing...';}
$(this.submit_button).val(processing_lablel);$(this.submit_button).attr('disabled','disabled');}else{$(this.submit_button).hide();$(this.loader_selector).show();}
$(this.frm_id).addClass('form-processing');}
if(status=='stop'){if(empty(this.loader_selector)){$(this.submit_button).val(this.old_submit_label);$(this.submit_button).removeAttr('disabled');}else{$(this.loader_selector).hide();$(this.submit_button).show();}
$(this.frm_id).removeClass('form-processing');}},handle_error:function(data){$(this.error_response_target).show().addClass('pma-error-submission-failed').html(data.error_message);this.scroll_to(this.error_response_target)
$(document).trigger('pma_handle_submission_error',this);},resize_iframe:function(){if($.isFunction($.fn.responsiveIframe)){if(document.getElementById('donation_iframe')){$('#donation_iframe').responsiveIframe();var myIframe=document.getElementById('donation_iframe');myIframe.onload=function(){}}
if($('.formbuilder_shortcode').length>0){$('.formbuilder_shortcode').responsiveIframe();}}},scroll_to:function(target){$('html, body').animate({scrollTop:$(target).offset().top},1000);},response_handler:function(data){this.data=data;if(data.status==='REDIRECT'){window.location.href=data.url;return false;}
if(data.status!='S'){this.handle_error(data);return false;}
var is_secondary=data.is_secondary;var is_last=data.is_last;if(data.success_url!='NONE'){window.location.href=data.success_url;return;}
if(data.is_secondary=='Y'){var next_alert_content=$(data.next_alert_content).filter('#pma-root-node').html();$('#pma-root-node').html(next_alert_content);this.scroll_to(this.response_target)
$(document).trigger('pma_handle_next_alert',this);this.init();}else{$(this.response_target).show()
$(this.response_target).html('<div class="thank-you">'+data.success_message+'</div>');this.resize_iframe();this.scroll_to(this.response_target);$(document).trigger('pma_handle_last_alert',this);}},skip_alert:function(post_id,ens_id,elem){var pma_obj=this;if(typeof sendEvent==="function"){sendEvent(petaGA_FormCategory_TakeAction,'Skip',this.get_alert_title());}
$(elem).html('Processing..')
$(elem).addClass('skip-button-loader')
var prev_thanks_message=$('.pma-thanks-next-alert').html();var locale=$('#locale').val();if(empty(locale)){locale='en';}
$.post(pma_ajax_url,{w_post_id:post_id,ens_id:ens_id,locale:locale,'action':'get_next_alert',},function(data){$(elem).html('Skip >>');$(elem).removeClass('skip-button-loader')
$(elem).html('Skip >>');var is_secondary=data.is_secondary;var is_last=data.is_last;if(data.is_next_alert_available=='N'){if(data.success_url!='NONE'){window.location.href=data.success_url;return;}else{$('#pma-root-node').html(data.success_message);pma_obj.resize_iframe();}}else{var next_alert_content=$(data.next_alert_content).filter('#pma-root-node').html();$('#pma-root-node').html(next_alert_content);$(document).trigger('pma_handle_next_alert',this);$('.pma-thanks-next-alert').html(prev_thanks_message);pma_obj.init();}},'json');return false;},populate_form:function(frm_id){var pma_obj=this;var cok=$.cookie(this.cookie_name);if(!empty(cok)){var cok_obj=JSON.parse(cok);$.each(cok_obj,function(fieldName,fieldValue){field=$('input[name="'+fieldName+'"]');$(field).each(function(){if($(this).hasClass(pma_obj.cookie_fld_class)){if($(this).attr('type')=='checkbox'){$(this).attr('checked',true);}if($(this).attr('type')=='radio'){$('.donation-amount-'+fieldValue).attr('checked',true);}else{if(!empty(fieldValue)){pma_obj.form_populated='Y';}
$(this).val(fieldValue);}}})
field=$('select[name="'+fieldName+'"]');if(field.hasClass(pma_obj.cookie_fld_class)){field.val(fieldValue);}})}},get_alert_title:function(){return $('input[name="pma_alert_title"]').val();},track_form:function(){var alert_title=this.get_alert_title();if(!empty(alert_title)){var element_to_track='#pma-root-node';var scroll_reach=0;ga_fired=false;var temp_scroll_reach=0;var scroll_reach_pixels=0;var temp_scroll_reach_pixels=0;if($(element_to_track).length>0&&!ga_fired){$(window).scroll(function(){temp_scroll_reach=Math.floor(100*($(window).scrollTop()+$(window).height()-$(element_to_track).offset().top)/$(element_to_track).height());temp_scroll_reach_pixels=Math.floor($(window).scrollTop()+$(window).height());if(temp_scroll_reach>scroll_reach){scroll_reach=temp_scroll_reach;scroll_reach_pixels=temp_scroll_reach_pixels;if(!ga_fired&&typeof sendEvent==="function"){sendEvent(petaGA_FormCategory_TakeAction,petaGA_FormAction_Initiated,alert_title);}
ga_fired=true;$(window).unbind('scroll');}});}}},store_form:function(frm){var frm_id='#'+$(frm).attr('id');var cok=$.cookie(this.cookie_name);if(!empty(cok)){cok=JSON.parse(cok);}else{cok={};}
var pma_obj=this;$(frm_id+' input[type="text"]').each(function(){if($(this).hasClass(pma_obj.cookie_fld_class)){cok[$(this).attr('name')]=$.trim($(this).val());}});$(frm_id+' input[type="email"]').each(function(){if($(this).hasClass(pma_obj.cookie_fld_class)){cok[$(this).attr('name')]=$.trim($(this).val());}});$(frm_id+' input[type="tel"]').each(function(){if($(this).hasClass(pma_obj.cookie_fld_class)){cok[$(this).attr('name')]=$.trim($(this).val());}});$(frm_id+' input[name="amount"]').each(function(){if($(this).hasClass(pma_obj.cookie_fld_class)&&$(this).is(':checked')){if($(this).attr('id')=="donate_amount_other_radio"){cok[$(this).attr('name')]=$.trim($(frm_id+' #donate_amount_other_text').val());}else{cok[$(this).attr('name')]=$.trim($(this).val());}}});$(frm_id+' input[name="recurrpay"]').each(function(){if($(this).hasClass(pma_obj.cookie_fld_class)&&$(this).is(':checked')){cok[$(this).attr('name')]=$.trim($(this).val());}else{delete cok[$(this).attr('name')];}
return false;});$(frm_id+' select').each(function(){if($(this).hasClass(pma_obj.cookie_fld_class)){cok[$(this).attr('name')]=$.trim($(this).val());}});cok_s=JSON.stringify(cok);$.cookie(this.cookie_name,cok_s,{expires:60,path:'/'});},toggle_letter:function(obj){var source=$('.pma-letter');var target=$('.mobile-pma-letter');var link=$(obj);if(link.data('cloned')=='Y'){target.toggle();if(target.css('display')=='none'){link.find('.toggle-arrow').html('&#43;')}else{link.find('.toggle-arrow').html('&#45;')}}else{var d=source.clone();source.remove();target.toggle();target.html(d);link.data('cloned','Y');link.find('.toggle-arrow').html('&#45;')}},change_section_background:function(){var templ=$('#pma_template').val();if(templ=='mineral'){var parent=$('#pma-root-node').parent().parent();if(parent.hasClass('section-full-width')){parent.addClass('section-full-width-en-alert')}}},populate_utm_params:function(parent){var map={'utm_source':'en_txn1','utm_medium':'en_txn2','utm_campaign':'en_txn3','utm_content':'en_txn4','utm_term':'en_txn5',};var prms='';if(empty(parent)){parent='';}else{parent=parent+' ';}
var qs=window.location.href.slice(window.location.href.indexOf('?')+1).split('&');for(i=0;i<qs.length;i++){var q=qs[i].split('=');if(!empty(map[q[0]])){var name=map[q[0]];if(!empty(q[1])&&$(parent+'#'+name).length<1){prms=prms+'<input type="hidden" name="'+name+'" value="'+q[1]+'"'+' id="'+name+'" >';}}}
if(!empty(prms)){$(parent+'#pma-utm-params').html(prms);}},remove_p_tags:function(){var str=$('#pma-message-body').val();if(empty(str)){return;}
var str=str.replace(/(<p[^>]+?>|<p>)/img,"");var str=str.replace(/(<\/p>)/img,"\r\n");$('#pma-message-body').val(str);},}
return PMA;}(jQuery);PMA_FORM=function($){var FORM={validation:[],mode:'submit',validate:function(frm){main=this;this.validation.status=true;this.remove_error();frm_id='#'+$(frm).attr('id');$(frm_id+' input').each(function(){main.remove_error_class(this);main.validate_field(this)});$(frm_id+' select').each(function(){if(!$(this).hasClass('date')){main.remove_error_class(this);main.validate_field(this)}});$(frm_id+' textarea').each(function(){main.remove_error_class(this);main.validate_field(this)});if(!this.validate_dob()){this.validation.status=false;}
if(!this.validate_mobile_optin()){this.validation.status=false;}
return this.validation.status;},remove_error_class:function(elem){$(elem).removeClass('validation_error');},show_error:function(elem,message,type){this.validation.status=false;this.validation.type=type;this.validation.field_name=$(elem).attr('name');this.validation.message=message;if(this.mode!='inline'){$(elem).focus();}
$(elem).parent().append('<div class="error-wrapper">'+this.validation.message+'</div>')
$(elem).addClass('validation_error');},remove_error:function(){$('.error-wrapper').remove();},validate_field:function(obj){var obj_val=$(obj).val();var st=true;if($(obj).hasClass('requiredrecaptcha')&&grecaptcha.getResponse()==''){var field_name=$(obj).data('field-name');m="Please check I'm not a robot";this.show_error(obj,m,'captcha')
return false;}
if($(obj).hasClass('required')&&empty(obj_val)){var field_name=$(obj).data('field-name');var m=$(obj).data('val-msg-req');if(empty(m)){m=empty(field_name)?'This field is required.':field_name+' is required.';}
this.show_error(obj,m,'required')
return false;}
if($(obj).hasClass('letters')&&obj_val!=''){if(!obj.value.match(/^[a-zA-Z \. \, \'\s]+$/)){var m='Please use only  Alphabets( A-Z,a-z ), Comma( , ), Dot( . ) and Asterisk( \' ) ';this.show_error(obj,m,'alpha')
return false;}}
if($(obj).hasClass('numbers')&&obj_val!=''){if(!obj.value.match(/^[0-9\.]+$/)){var m='Please enter only numbers.';this.show_error(obj,m,'numbers')
return false;}}
if($(obj).hasClass('email')&&obj_val!=''){if(!this.validate_email(obj_val)){var m=$(obj).data('val-msg-email');if(empty(m)){m='Enter a valid e-mail address.';}
this.show_error(obj,m,'email')
return false;}}
if($(obj).hasClass('phone')&&obj_val!=''){if(!this.validate_phone(obj_val)){var m='Enter a valid phone number.';this.show_error(obj,m,'phone')
return false;}}
if($(obj).hasClass('zip4')&&obj_val!=''){if(obj.value.length!=9&&obj.value.length!=5){var m='The zip code must be a numeric 5-digit or 9-digit code.';this.show_error(obj,m,'zip4')
return false;}}
return true;},validate_dob:function(){var st=true;alert_text=false;var day_obj=$('#dob_day');var month_obj=$('#dob_month');var year_obj=$('#dob_year');year_obj.removeClass('validation_error');month_obj.removeClass('validation_error');day_obj.removeClass('validation_error');var day=day_obj.val();var month=month_obj.val();var year=year_obj.val();if(day_obj.hasClass('required')&&empty(day)&&empty(month)&&empty(year)){month_obj.parent().append('<div class="error-wrapper">'+'Date of Birth is required.'+'</div>')
year_obj.addClass('validation_error');month_obj.addClass('validation_error');day_obj.addClass('validation_error');st=false;return st;}else if(!empty(day)||!empty(month)||!empty(year)){var dob_val=month+'-'+day+'-'+year;var date_regex=/([1-9]|1[012])[-]([1-9]|[12][0-9]|3[0])[-](19|20)\d\d/;if(month=='1'||month=='3'||month=='5'||month=='7'||month=='8'||month=='10'||month=='12'){var date_regex=/([1-9]|1[012])[-]([1-9]|[12][0-9]|3[01])[-](19|20)\d\d/;}
if(month=='4'||month=='6'||month=='9'||month=='11'){var date_regex=/([1-9]|1[012])[-]([1-9]|[12][0-9]|3[0])[-](19|20)\d\d/;}
if(month=='2'){var date_regex=/([1-9]|1[012])[-]([1-9]|[12][0-9])[-](19|20)\d\d/;}
if(!date_regex.test(dob_val)){year_obj.parent().append('<div class="error-wrapper">'+'Please enter correct Date of Birth.'+'</div>');year_obj.addClass('validation_error');month_obj.addClass('validation_error');day_obj.addClass('validation_error');st=false;return st;}}
if(month&&day&&year){var under_13_redirect_url="http://petakids.com/";var under_13_text="You are too young to participate on this Web site. You will be redirected to PETAKids.com";var under_13=new Date();under_13.setFullYear(under_13.getFullYear()-13);var dob=Date.parse(month+' '+day+', '+year);if((under_13-dob)<0){var alert_text=under_13_text;var confirm_first=false;var redirect_url=under_13_redirect_url;var force_redirect=false;warningType=13;}
if(alert_text){if(warningType==13){alert(alert_text);window.location=redirect_url;return false;}}}
return st;},validate_mobile_optin:function(){var tc_check=$('#tc_mobile_optin');var mobile_phone=$('#mobile_phone');if(!empty(mobile_phone.val())){if(!tc_check.is(':checked')){var message='Please remove your phone number from the field above if you do not want to accept text messages from PETA. If you would like to receive messages, please accept the terms and conditions by checking the box above.';this.show_error(tc_check,message,'mobile_optin');return false;}}
if(tc_check.is(':checked')){if(mobile_phone.val()==''){var message='Mobile Number is required.';this.show_error(mobile_phone,message,'mobile_optin');return false;}
var mbl=mobile_phone.val();if(mbl.replace(/[^0-9]/g,"").length!=10){var message='Please enter a valid mobile phone number.';this.show_error(mobile_phone,message,'mobile_optin');return false;}}
return true;},handle_blur:function(elem){$(elem).removeClass('validation_error');$(elem).next('.error-wrapper').remove();this.validate_field(elem)},handle_focus:function(elem){$(elem).removeClass('validation_error');$(elem).next('.error-wrapper').remove();},validate_inline:function(frm_id){this.mode='inline';main=this;$(frm_id+' input').each(function(){$(this).on('blur',function(){if($(this).hasClass('trim-spaces')){$(this).val($.trim($(this).val()));}
if(!$(this).hasClass('validate-email')){main.handle_blur(this)}})
$(this).on('focus',function(){if(!$(this).hasClass('validate-email')){main.handle_focus(this)}})})
$(frm_id+'select').each(function(){if(!$(this).hasClass('date')){$(this).on('blur',function(){main.handle_blur(this)})
$(this).on('focus',function(){main.handle_focus(this)})}})},validate_email:function(el){var str=el;str=$.trim(str);var filter=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;var st;if(filter.test(str)){st=true;}else{st=false;}
return st;},validate_phone:function(mbl){if(mbl.replace(/[^0-9]/g,"").length!=10){return false;}
return true;},}
return FORM;}(jQuery);PMA_STICKY=function($){var STICKY={init:function(elem,elem_upper,elem_lower){if(this.check_to_scroll()){this.scroll_event(elem,elem_upper,elem_lower)
var pma_obj=this;$(window).resize(function(){$(window).unbind("scroll");$(elem).attr("style",'');pma_obj.scroll_event(elem,elem_upper,elem_lower);})}},check_to_scroll:function(){if($(window).width()>760){return true;}else{return false;}},scroll_event:function(elem,elem_upper,elem_lower){off=($(elem).offset().left)+'px';width=$(elem).css("width");common={'top':'100px',}
def_offs=360;$(window).scroll(function(){var abscss={'position':'absolute','right':'0px',}
var fixecss={'position':'fixed','width':width,'top':'0px','right':'10px','left':off}
var limit=$(elem_lower).offset().top-$(elem).outerHeight(true);var t=$(window).scrollTop();if(t>def_offs&&t<limit){$(elem).attr('style','');$(elem).css(fixecss);}else if(t>limit){limit2=limit-def_offs;$(elem).attr('style','');$(elem).css({'position':'absolute','right':'0px',});}else{$(elem).attr('style','');$(elem).css(abscss);}});},}
return STICKY;}(jQuery);PMA_DONATION_FORM=function($){var DONATION_FORM={init:function(frm_id){frm_id='#'+frm_id;$('.input-other-amount').on('click',function(){$('#donate_amount_other_radio').prop('checked',true);});$('.input-amount').on('click',function(){$('.input-other-amount').val('');});$('.pma-donation-shortcode input').on('click',function(){$('.pma-donation-shortcode .privacy-policy').show();});$('.thermometer-goal').thermometer();var donation_title=this.get_title(frm_id);var layout=$(frm_id+' #layout').val()
if(!empty(donation_title)&&typeof sendEvent==="function"&&layout!='shortcode'){sendEvent(petaGA_FormCategory_eNews,petaGA_FormAction_Initiated,donation_title);}},submit:function(frm){this.frm_id='#'+$(frm).attr('id');this.frm=frm;pma_obj:this;var validation_status=PMA_FORM.validate(frm);if(!validation_status){return validation_status;}
PMA_FRONT.store_form(frm)
this.frm_action=$(this.frm_id).attr('action');if($(this.frm_id+' input.email').length<1){var donation_title=this.get_title(this.frm_id);if(!empty(donation_title)&&typeof sendEvent==="function"){sendEvent(petaGA_FormCategory_eNews,petaGA_FormAction_Submitted,donation_title);}
location.href=this.frm_action;return false;}
PMA_FRONT.submit_button=$(this.frm_id).data('submit_button');PMA_FRONT.old_submit_label=$(PMA_FRONT.submit_button).attr('value');PMA_FRONT.loader_selector=$(this.frm_id).data('loader');this.response_target=$(this.frm_id).data('response_target');this.error_response_target=$(frm_id).data('error_response_target');PMA_FRONT.loader('start');var pma_obj=this;var post_data=$(frm_id).serialize();post_data=post_data+'&action=ens_submit_donation_teaser';$.post(pma_ajax_url,post_data,function(data){PMA_FRONT.loader('stop');var donation_title=pma_obj.get_title(pma_obj.frm_id);if(!empty(donation_title)&&typeof sendEvent==="function"){sendEvent(petaGA_FormCategory_eNews,petaGA_FormAction_Submitted,donation_title);}
if(data.status=='S'&&!empty(data.donation_url)){location.href=data.donation_url;}else{location.href=pma_obj.frm_action;}},'json');return false;},sync_middleware:function(frm){this.frm_id='#'+$(frm).attr('id');this.frm=frm;pma_obj:this;var validation_status=PMA_FORM.validate(frm);if(!validation_status){return validation_status;}
var vda=this.validate_donation_amount(frm_id);if(!vda){return vda;}
PMA_FRONT.store_form(frm)
this.frm_action=$(this.frm_id).attr('action');if($(this.frm_id+' input.email').length<1){var donation_title=this.get_title(this.frm_id);if(!empty(donation_title)&&typeof sendEvent==="function"){sendEvent(petaGA_FormCategory_eNews,petaGA_FormAction_Submitted,donation_title);}
location.href=this.frm_action;return false;}
PMA_FRONT.submit_button=$(this.frm_id).data('submit_button');PMA_FRONT.old_submit_label=$(PMA_FRONT.submit_button).attr('value');PMA_FRONT.loader_selector=$(this.frm_id).data('loader');this.response_target=$(this.frm_id).data('response_target');this.error_response_target=$(frm_id).data('error_response_target');PMA_FRONT.loader('start');var pma_obj=this;var action=$(frm).attr('action');var data=JSON.stringify($(frm).serializeArray());jQuery.ajax({type:'POST',url:$(frm).attr('action'),data:data,crossDomain:true,success:function(data){PMA_FRONT.loader('stop');var donation_title=$(' input[name="pma_donation_title"]').val();if(!empty(donation_title)&&typeof sendEvent==="function"){sendEvent(petaGA_FormCategory_eNews,petaGA_FormAction_Submitted,donation_title);}
$('body').append(data);}});return false;},get_title:function(frm_id){return $(frm_id+' input[name="pma_donation_title"]').val();},validate_donation_amount:function(frm_id){var status=true;if($(frm_id+' input[id="donate_amount_other_radio"]').is(':checked')){var other_amnt=$(frm_id+' input[id="donate_amount_other_text"]');var amnt=other_amnt.val();if(empty(amnt)){PMA_FORM.show_error(other_amnt,other_amnt.data('val-msg-reuired'),'requird')
status=false;}}
return status;},}
return DONATION_FORM;}(jQuery);PMA_SUBSCRIPTION_FORM=function($){var SUBSCRIPTION_FORM={init:function(frm_id){frm_id='#'+frm_id;var layout=$(frm_id+' #layout').val()
var ga_label=this.get_ga_label(frm_id);if(!empty(ga_label)&&typeof sendEvent==="function"&&layout!='shortcode'){sendEvent(petaGA_FormCategory_eNews,petaGA_FormAction_Initiated,ga_label);}
$(frm_id+' .privacy-policy').hide();$(frm_id).delegate(':input','focus',function(){$(frm_id+' .privacy-policy').fadeIn();});$("body").mouseup(function(e){var container=$(frm_id);if(!container.is(e.target)&&!container.has(e.target).length){container.find('.privacy-policy').fadeOut();}});},submit:function(frm){this.frm_id='#'+$(frm).attr('id');this.frm=frm;pma_obj:this;var validation_status=PMA_FORM.validate(frm);if(!validation_status){return validation_status;}
PMA_FRONT.store_form(frm)
this.frm_action=$(this.frm_id).attr('action');PMA_FRONT.submit_button=$(this.frm_id).data('submit_button');PMA_FRONT.old_submit_label=$(PMA_FRONT.submit_button).attr('value');PMA_FRONT.loader_selector=$(this.frm_id).data('loader');this.response_target=$(this.frm_id).data('response_target');this.error_response_target=$(frm_id).data('error_response_target');PMA_FRONT.loader('start');var pma_obj=this;var post_data=$(frm_id).serialize();post_data=post_data+'&action=ens_submit_subscription_form';$.post(pma_ajax_url,post_data,function(data){PMA_FRONT.loader('stop');var ga_label=pma_obj.get_ga_label(pma_obj.frm_id);if(!empty(ga_label)&&typeof sendEvent==="function"){sendEvent(petaGA_FormCategory_eNews,petaGA_FormAction_Submitted,ga_label);}
if(data.status=='S'&&!empty(data.success_message)){$(pma_obj.response_target).html('<div class="thank-you">'+data.success_message+'</div>')
$(pma_obj.response_target).show().css('display','flex');$('.pma-subscription-splash-content').hide();$('#pspModal .bg-image').hide();}else{$(pma_obj.error_response_target).html(data.error_message).show();}},'json');return false;},get_ga_label:function(frm_id){var ga_label=$(frm_id+' input[name="ga_label"]').val();var title=$(frm_id+' input[name="pma_subscription_form_title"]').val();if(!empty(ga_label)){return ga_label;}else{return title;}},}
return SUBSCRIPTION_FORM;}(jQuery);jQuery(document).ready(function($){PMA_FRONT.init();});lguid='';pma_country_detectd=''